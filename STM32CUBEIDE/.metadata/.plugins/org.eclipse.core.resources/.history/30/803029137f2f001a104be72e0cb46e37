/**
 ******************************************************************************
 * @file    main.c
 * @author  Auto-generated by STM32CubeIDE
 * @version V1.0
 * @brief   Default main function.
 ******************************************************************************
 */



#include <stdio.h>
#include "uart_driver.h"
#include <stdint.h>

#define F_CPU 16000000UL

#define PERIPH_BASE 0x40000000
#define RCC_BASE (PERIPH_BASE + 0x23800)
#define AHB1ENR (RCC_BASE + 0x30)

#define GPIO_PINS_PER_PORT 16
#define GPIO_C (2 * GPIO_PINS_PER_PORT)
#define GPIO_PORT_C 2 //GPIO C

#define LCD_DATA_GPIO_PORT 0 // GPIO A
#define LCD_DATA_GPIO_BASE 8
#define LCD_RS_GPIO (8)
#define LCD_RW_GPIO (9)
#define LCD_E_GPIO (10)

#define LCD_RW_WRITE 0
#define LCD_RW_READ 1
#define LCD_RS_INSTR 0
#define LCD_RS_DATA 1
#define LCD_E_START 1
#define LCD_E_IDLE 0
#define LCD_BUSY 0x80

//Fix prototypes
void lcd_init(void);
void lcd_clear(void);
void lcd_home(void);
void lcd_set_position(void);
void lcd_print_string(void);
void lcd_print_num(void);

// main
int main(void){
	//	init_usart2(19200,F_CPU);
	//	printf("Hello World!!\n");

	//gpio mode output
	while(output <= 15) {
		uint32_t *gpioMode = (uint32_t*) GPIO_MODER;
		*gpioMode = (*gpioMode|(0b01<<(output*2)));
		output++;
	}
	return 0;
}


void lcd_init() {
	//enable clock register (gpio A)
	uint32_t *rcc = (uint32_t*) AHB1ENR;
	*rcc = (*rcc|(1<<LCD_DATA_GPIO_PORT));



	//initialize I/O
	//enable gpio C
	//RS_GPIO
	*rcc = (*rcc|(1<<GPIO_PORT_C));
	uint32_t *gpioMode = (uint32_t*) GPIO_MODER;
	*gpioMode = (*gpioMode|(0b01<<(LCD_RS_GPIO*2)));

	//RW_GPIO
	*gpioMode = (*gpioMode|(0b01<<(LCD_RW_GPIO*2)));

	//E_GPIO
	*gpioMode = (*gpioMode|(0b01<<(LCD_E_GPIO*2)));

	//call lcd_clear

	//call lcd_home

}


void lcd_clear() {
	//clears lcd

}


void lcd_home() {
	//homes lcd

}


void lcd_set_position() {

}

/**
  ******************************************************************************
  * @file    main.c
  * @author  Auto-generated by STM32CubeIDE
  * @version V1.0
  * @brief   Default main function.
  ******************************************************************************
*/



#include <stdio.h>
#include "uart_driver.h"
#include "registers.h"

#define F_CPU 16000000UL

// main
int main(void){

	while (1!=0) {

	init_usart2(19200,F_CPU);
	//enable clock GPIO B
	uint32_t *clock = (uint32_t) RCC_BASE;
	*clock |= (1<<1);

	tone(4,1000,500);

	//analog mode PB4
	uint32_t *speaker = (uint32_t) GPIOB_BASE;
	*speaker |= (0b11<<(4*2));

	//ODR or alternate func (low/high) reg
	//Insert FLOAT?
	uint32_t *note = (uint32_t)(0x20 + GPIOB_BASE);
	*note = (0b0011<<(4*4));

	//uint32_t *note = (uint32_t)(0x20 + GPIOB_BASE);
	//*note |= (0b0100);
	//*note |= (0b1<<25);

	delay_ms(1);

	}

	// never return
	for(;;){}

	return 0;
}

